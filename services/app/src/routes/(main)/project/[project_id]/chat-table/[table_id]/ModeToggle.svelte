<script lang="ts">
	import { cn } from '$lib/utils';
	import { createEventDispatcher } from 'svelte';

	const dispatch = createEventDispatcher<{
		checkedChange: { event: MouseEvent; value: boolean };
	}>();

	let className: string | undefined | null = undefined;
	export { className as class };

	export let id: string | undefined = undefined;
	export let defaultChecked: boolean = false;
	export let disabled: boolean | undefined = undefined;
	export let required: boolean | undefined = undefined;
	export let name: string | undefined = undefined;

	export let checked: boolean = defaultChecked;
	export let validateBeforeChange: (e: MouseEvent) => boolean = () => true;

	function toggle(e: MouseEvent) {
		if (validateBeforeChange(e) == false) return;
		checked = !checked;
		dispatch('checkedChange', { event: e, value: checked });
	}

	function preventEnter(event: KeyboardEvent) {
		if (event.key === 'Enter') event.preventDefault();
	}
</script>

<button
	on:click={toggle}
	on:keydown={preventEnter}
	{id}
	{disabled}
	aria-checked={checked}
	type="button"
	role="checkbox"
	value="on"
	class={cn(
		'peer relative flex items-center justify-center gap-2.5 h-9 w-[72px] shrink-0 rounded-sm bg-[#F0F0F0] data-dark:bg-[#282C34] ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed  aria-checked:border-[#4169e1] data-dark:aria-checked:border-[#5b7ee5] overflow-hidden',
		className
	)}
>
	<svg width="23" height="22" viewBox="0 0 23 22" fill="none" xmlns="http://www.w3.org/2000/svg">
		<path
			fill-rule="evenodd"
			clip-rule="evenodd"
			d="M3.27148 5.73509C3.27148 5.0233 3.55424 4.34066 4.05756 3.83734C4.56087 3.33403 5.24351 3.05127 5.95531 3.05127H16.6906C17.4024 3.05127 18.085 3.33403 18.5884 3.83734C19.0917 4.34066 19.3744 5.0233 19.3744 5.73509V13.6591C19.3744 14.3709 19.0917 15.0535 18.5884 15.5568C18.085 16.0601 17.4024 16.3429 16.6906 16.3429H11.5672L8.39893 18.9972C8.30108 19.0791 8.1819 19.1315 8.05536 19.1481C7.92882 19.1646 7.80017 19.1448 7.68452 19.0908C7.56886 19.0369 7.47099 18.9511 7.4024 18.8434C7.3338 18.7358 7.29731 18.6109 7.29722 18.4833V16.3429H5.95531C5.24351 16.3429 4.56087 16.0601 4.05756 15.5568C3.55424 15.0535 3.27148 14.3709 3.27148 13.6591V5.73509ZM5.95531 4.39318C5.59941 4.39318 5.25809 4.53456 5.00643 4.78622C4.75478 5.03788 4.6134 5.3792 4.6134 5.73509V13.6591C4.6134 14.015 4.75478 14.3563 5.00643 14.608C5.25809 14.8596 5.59941 15.001 5.95531 15.001H7.96818C8.14612 15.001 8.31678 15.0717 8.44261 15.1975C8.56844 15.3233 8.63913 15.494 8.63913 15.672V17.0454L10.8922 15.1573C11.013 15.0563 11.1655 15.0009 11.323 15.001H16.6906C17.0465 15.001 17.3878 14.8596 17.6395 14.608C17.8911 14.3563 18.0325 14.015 18.0325 13.6591V5.73509C18.0325 5.3792 17.8911 5.03788 17.6395 4.78622C17.3878 4.53456 17.0465 4.39318 16.6906 4.39318H5.95531Z"
			fill="#C2C2C2"
		/>
	</svg>

	<svg width="23" height="22" viewBox="0 0 23 22" fill="none" xmlns="http://www.w3.org/2000/svg">
		<path
			d="M4.29596 6.40576C4.11801 6.40576 3.94735 6.47645 3.82152 6.60228C3.69569 6.72811 3.625 6.89877 3.625 7.07672C3.625 7.25467 3.69569 7.42533 3.82152 7.55115C3.94735 7.67698 4.11801 7.74767 4.29596 7.74767H19.057C19.2349 7.74767 19.4056 7.67698 19.5314 7.55115C19.6573 7.42533 19.7279 7.25467 19.7279 7.07672C19.7279 6.89877 19.6573 6.72811 19.5314 6.60228C19.4056 6.47645 19.2349 6.40576 19.057 6.40576H4.29596Z"
			fill="#C2C2C2"
		/>
		<path
			fill-rule="evenodd"
			clip-rule="evenodd"
			d="M14.1807 11.1025C13.5163 11.1025 12.8792 11.3665 12.4094 11.8363C11.9397 12.3061 11.6758 12.9432 11.6758 13.6076V15.6751C11.6758 16.8216 12.4465 17.7886 13.4977 18.0859V18.6178C13.4978 18.7766 13.5432 18.9321 13.6286 19.066C13.7139 19.2 13.8357 19.3068 13.9797 19.3739C14.1236 19.4411 14.2837 19.4658 14.4411 19.4451C14.5986 19.4245 14.7469 19.3594 14.8687 19.2574L16.1545 18.1802H17.5206C18.1849 18.1802 18.822 17.9163 19.2918 17.4465C19.7615 16.9767 20.0255 16.3395 20.0255 15.6751V13.6076C20.0255 12.9432 19.7615 12.3061 19.2918 11.8363C18.822 11.3665 18.1849 11.1025 17.5206 11.1025H14.1807ZM15.3146 16.7056L15.0532 16.9235C14.9796 16.7977 14.8744 16.6934 14.748 16.6209C14.6216 16.5483 14.4784 16.5102 14.3326 16.5102H14.1807C13.9592 16.5102 13.7469 16.4222 13.5903 16.2656C13.4337 16.109 13.3457 15.8966 13.3457 15.6751V13.6076C13.3457 13.3862 13.4337 13.1738 13.5903 13.0172C13.7469 12.8606 13.9592 12.7726 14.1807 12.7726H17.5206C17.742 12.7726 17.9544 12.8606 18.111 13.0172C18.2676 13.1738 18.3555 13.3862 18.3555 13.6076V15.6751C18.3555 15.8966 18.2676 16.109 18.111 16.2656C17.9544 16.4222 17.742 16.5102 17.5206 16.5102H15.8506C15.6545 16.5103 15.4648 16.5795 15.3146 16.7056Z"
			fill="#C2C2C2"
		/>
		<path
			d="M3.625 15.1283C3.625 14.9504 3.69569 14.7797 3.82152 14.6539C3.94735 14.5281 4.11801 14.4574 4.29596 14.4574H7.65074C7.82868 14.4574 7.99934 14.5281 8.12517 14.6539C8.251 14.7797 8.32169 14.9504 8.32169 15.1283C8.32169 15.3063 8.251 15.4769 8.12517 15.6028C7.99934 15.7286 7.82868 15.7993 7.65074 15.7993H4.29596C4.11801 15.7993 3.94735 15.7286 3.82152 15.6028C3.69569 15.4769 3.625 15.3063 3.625 15.1283ZM4.29596 10.4316C4.11801 10.4316 3.94735 10.5023 3.82152 10.6282C3.69569 10.754 3.625 10.9246 3.625 11.1026C3.625 11.2805 3.69569 11.4512 3.82152 11.577C3.94735 11.7029 4.11801 11.7736 4.29596 11.7736H9.6636C9.84155 11.7736 10.0122 11.7029 10.138 11.577C10.2639 11.4512 10.3346 11.2805 10.3346 11.1026C10.3346 10.9246 10.2639 10.754 10.138 10.6282C10.0122 10.5023 9.84155 10.4316 9.6636 10.4316H4.29596Z"
			fill="#C2C2C2"
		/>
	</svg>

	<div
		class="absolute top-1/2 -translate-y-1/2 left-0 flex items-center justify-center h-7 w-7 bg-white rounded-sm transition-transform {checked
			? 'translate-x-10'
			: 'translate-x-1'}"
	>
		<div class="relative">
			<svg
				width="23"
				height="22"
				viewBox="0 0 23 22"
				fill="none"
				xmlns="http://www.w3.org/2000/svg"
				class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 transition-opacity {checked
					? 'opacity-0'
					: 'opacity-100'}"
			>
				<path
					fill-rule="evenodd"
					clip-rule="evenodd"
					d="M3.27148 5.73509C3.27148 5.0233 3.55424 4.34066 4.05756 3.83734C4.56087 3.33403 5.24351 3.05127 5.95531 3.05127H16.6906C17.4024 3.05127 18.085 3.33403 18.5884 3.83734C19.0917 4.34066 19.3744 5.0233 19.3744 5.73509V13.6591C19.3744 14.3709 19.0917 15.0535 18.5884 15.5568C18.085 16.0601 17.4024 16.3429 16.6906 16.3429H11.5672L8.39893 18.9972C8.30108 19.0791 8.1819 19.1315 8.05536 19.1481C7.92882 19.1646 7.80017 19.1448 7.68452 19.0908C7.56886 19.0369 7.47099 18.9511 7.4024 18.8434C7.3338 18.7358 7.29731 18.6109 7.29722 18.4833V16.3429H5.95531C5.24351 16.3429 4.56087 16.0601 4.05756 15.5568C3.55424 15.0535 3.27148 14.3709 3.27148 13.6591V5.73509ZM5.95531 4.39318C5.59941 4.39318 5.25809 4.53456 5.00643 4.78622C4.75478 5.03788 4.6134 5.3792 4.6134 5.73509V13.6591C4.6134 14.015 4.75478 14.3563 5.00643 14.608C5.25809 14.8596 5.59941 15.001 5.95531 15.001H7.96818C8.14612 15.001 8.31678 15.0717 8.44261 15.1975C8.56844 15.3233 8.63913 15.494 8.63913 15.672V17.0454L10.8922 15.1573C11.013 15.0563 11.1655 15.0009 11.323 15.001H16.6906C17.0465 15.001 17.3878 14.8596 17.6395 14.608C17.8911 14.3563 18.0325 14.015 18.0325 13.6591V5.73509C18.0325 5.3792 17.8911 5.03788 17.6395 4.78622C17.3878 4.53456 17.0465 4.39318 16.6906 4.39318H5.95531Z"
					fill="black"
				/>
			</svg>

			<svg
				width="23"
				height="22"
				viewBox="0 0 23 22"
				fill="none"
				xmlns="http://www.w3.org/2000/svg"
				class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 transition-opacity {checked
					? 'opacity-100'
					: 'opacity-0'}"
			>
				<path
					d="M4.29596 6.40576C4.11801 6.40576 3.94735 6.47645 3.82152 6.60228C3.69569 6.72811 3.625 6.89877 3.625 7.07672C3.625 7.25467 3.69569 7.42533 3.82152 7.55115C3.94735 7.67698 4.11801 7.74767 4.29596 7.74767H19.057C19.2349 7.74767 19.4056 7.67698 19.5314 7.55115C19.6573 7.42533 19.7279 7.25467 19.7279 7.07672C19.7279 6.89877 19.6573 6.72811 19.5314 6.60228C19.4056 6.47645 19.2349 6.40576 19.057 6.40576H4.29596Z"
					fill="black"
				/>
				<path
					fill-rule="evenodd"
					clip-rule="evenodd"
					d="M14.1807 11.1025C13.5163 11.1025 12.8792 11.3665 12.4094 11.8363C11.9397 12.3061 11.6758 12.9432 11.6758 13.6076V15.6751C11.6758 16.8216 12.4465 17.7886 13.4977 18.0859V18.6178C13.4978 18.7766 13.5432 18.9321 13.6286 19.066C13.7139 19.2 13.8357 19.3068 13.9797 19.3739C14.1236 19.4411 14.2837 19.4658 14.4411 19.4451C14.5986 19.4245 14.7469 19.3594 14.8687 19.2574L16.1545 18.1802H17.5206C18.1849 18.1802 18.822 17.9163 19.2918 17.4465C19.7615 16.9767 20.0255 16.3395 20.0255 15.6751V13.6076C20.0255 12.9432 19.7615 12.3061 19.2918 11.8363C18.822 11.3665 18.1849 11.1025 17.5206 11.1025H14.1807ZM15.3146 16.7056L15.0532 16.9235C14.9796 16.7977 14.8744 16.6934 14.748 16.6209C14.6216 16.5483 14.4784 16.5102 14.3326 16.5102H14.1807C13.9592 16.5102 13.7469 16.4222 13.5903 16.2656C13.4337 16.109 13.3457 15.8966 13.3457 15.6751V13.6076C13.3457 13.3862 13.4337 13.1738 13.5903 13.0172C13.7469 12.8606 13.9592 12.7726 14.1807 12.7726H17.5206C17.742 12.7726 17.9544 12.8606 18.111 13.0172C18.2676 13.1738 18.3555 13.3862 18.3555 13.6076V15.6751C18.3555 15.8966 18.2676 16.109 18.111 16.2656C17.9544 16.4222 17.742 16.5102 17.5206 16.5102H15.8506C15.6545 16.5103 15.4648 16.5795 15.3146 16.7056Z"
					fill="black"
				/>
				<path
					d="M3.625 15.1283C3.625 14.9504 3.69569 14.7797 3.82152 14.6539C3.94735 14.5281 4.11801 14.4574 4.29596 14.4574H7.65074C7.82868 14.4574 7.99934 14.5281 8.12517 14.6539C8.251 14.7797 8.32169 14.9504 8.32169 15.1283C8.32169 15.3063 8.251 15.4769 8.12517 15.6028C7.99934 15.7286 7.82868 15.7993 7.65074 15.7993H4.29596C4.11801 15.7993 3.94735 15.7286 3.82152 15.6028C3.69569 15.4769 3.625 15.3063 3.625 15.1283ZM4.29596 10.4316C4.11801 10.4316 3.94735 10.5023 3.82152 10.6282C3.69569 10.754 3.625 10.9246 3.625 11.1026C3.625 11.2805 3.69569 11.4512 3.82152 11.577C3.94735 11.7029 4.11801 11.7736 4.29596 11.7736H9.6636C9.84155 11.7736 10.0122 11.7029 10.138 11.577C10.2639 11.4512 10.3346 11.2805 10.3346 11.1026C10.3346 10.9246 10.2639 10.754 10.138 10.6282C10.0122 10.5023 9.84155 10.4316 9.6636 10.4316H4.29596Z"
					fill="black"
				/>
			</svg>
		</div>
	</div>
</button>
<input
	{disabled}
	{required}
	{name}
	bind:checked
	aria-hidden="true"
	tabindex="-1"
	type="checkbox"
	value="on"
	class="pointer-events-none absolute !m-0 h-4 w-4 opacity-0"
/>
